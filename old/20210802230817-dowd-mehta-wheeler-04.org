:PROPERTIES:
:ID:        5441beda-5a50-4afc-b612-beec158c93a6
:ROAM_REFS: https://www.blackhat.com/presentations/bh-europe-06/bh-eu-06-Wheeler-up.pdf
:END:
#+title: dowd-mehta-wheeler-04
#+filetags: :vcdb:c:nosolution:

* Description

* Code
#+begin_src c
char *ProfileDirectory = "c:\profiles";

BOOL LoadProfile(LPCSTR UserName) {
  HANDLE hFile;
  char buf[MAX_PATH];

  if(strlen(UserName) > MAX_PATH - strlen(ProfileDirectory) - 12) {
    return FALSE;
  }

  snprintf(buf, sizeof(buf), "%s\prof_%s.txt", ProfileDirectory, UserName);
  hFile = CreateFile(buf, GENERIC_READ, 0, NULL, OPEN_EXISTING, 0, NULL);

  // ... load profile data ...
}


#+end_src

* Solution
#+begin_src c

#+end_src