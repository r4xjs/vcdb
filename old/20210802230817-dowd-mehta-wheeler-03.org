:PROPERTIES:
:ID:        f000b96b-81a9-41e2-b48d-8fcc0e178f1a
:ROAM_REFS: https://www.blackhat.com/presentations/bh-europe-06/bh-eu-06-Wheeler-up.pdf
:END:
#+title: dowd-mehta-wheeler-03
#+filetags: :vcdb:c:nosolution:

* Description

* Code
#+begin_src c
HANDLE GetRequestedFile(LPCSTR requestedFile){
  if(strstr(requestedFile, "..")){
    return INVALID_HANDLE_VALUE;
  }
  if(strcmp(requestedFile, ".config") == 0){
    return INVALID_HANDLE_VALUE;
  }
  return CreateFile(requestedFile,
		    GENERIC_READ,
		    FILE_SHARED_READ,
		    NULL,
		    OPEN_EXISTING,
		    0,
		    NULL);
}

#+end_src

* Solution
#+begin_src c

#+end_src