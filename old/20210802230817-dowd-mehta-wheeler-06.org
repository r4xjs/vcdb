:PROPERTIES:
:ID:        573e3084-acf8-41bc-a2e9-a37a9f3e2321
:ROAM_REFS: https://www.blackhat.com/presentations/bh-europe-06/bh-eu-06-Wheeler-up.pdf
:END:
#+title: dowd-mehta-wheeler-06
#+filetags: :vcdb:c:nosolution:

* Description

* Code
#+begin_src c
request * head;
void server_thread() {
  while(1) {
    if(request_availabel()) {
      get_request(head);
      CreateThread(NULL,
		   0,
		   processing_thread_entrypoint,
		   NULL,
		   0);
    } else {
      wait_for_request();
    }
  }
}
void processing_thread_entrypoint() {
  request *req;
  // finf first unprocessed request
  for(req=head; req && !req->processed; req = req->next);
  if(req) {
    req->processed = 1;
    process_request(req);
  }
  ExitThread(0);
}

#+end_src

* Solution
#+begin_src c

#+end_src